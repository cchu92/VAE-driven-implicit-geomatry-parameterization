\doxysection{helper\+\_\+\+VAEstruc.\+py}
\hypertarget{helper___v_a_estruc_8py_source}{}\label{helper___v_a_estruc_8py_source}\index{D:/Dropbox/Dropbox/Fraunhofer\_Cluster/code\_for\_ITWM/VAE\_unit\_cell\_data/src/helper\_VAEstruc.py@{D:/Dropbox/Dropbox/Fraunhofer\_Cluster/code\_for\_ITWM/VAE\_unit\_cell\_data/src/helper\_VAEstruc.py}}
\mbox{\hyperlink{helper___v_a_estruc_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00001}\mbox{\hyperlink{namespacesrc_1_1helper___v_a_estruc}{00001}}\ \textcolor{comment}{\#\ define\ the\ VAE\ model}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00002}00002\ \textcolor{keyword}{import}\ torch}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00003}00003\ \textcolor{keyword}{from}\ torch\ \textcolor{keyword}{import}\ nn}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00007}00007\ \textcolor{comment}{\#\ \%\%\ DEMO\ TO\ DESIGN\ SIMPLE\ VAE\ MODEL}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00008}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e}{00008}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e}{VAE}}(nn.Module):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00009}00009\ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00010}00010\ \textcolor{stringliteral}{\ \ \ \ Variational\ Autoencoder\ (VAE)\ implemented\ using\ linear\ layers.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00011}00011\ \textcolor{stringliteral}{\ \ \ \ It\ encodes\ input\ data\ to\ a\ latent\ space\ representation\ and\ then\ decodes\ it\ back\ to\ the\ original\ input\ space.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00012}00012\ \textcolor{stringliteral}{\ \ \ \ The\ VAE\ consists\ of\ two\ main\ parts:\ an\ encoder\ and\ a\ decoder.\ Use\ dense\ layers\ to\ connect\ them.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00013}00013\ \textcolor{stringliteral}{\ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00014}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a051fac8e312d522318c5af226919057f}{00014}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a051fac8e312d522318c5af226919057f}{\_\_init\_\_}}(self):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00015}00015\ \ \ \ \ \ \ \ \ super().\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a051fac8e312d522318c5af226919057f}{\_\_init\_\_}}()}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00016}00016\ \ \ \ \ \ \ \ \ d\ =\ 20\ \textcolor{comment}{\#\ Dimension\ of\ latent\ space\ vector}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Encoder\ network:\ Maps\ inputs\ to\ the\ latent\ space\ representation.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00018}00018\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ encoder\ outputs\ two\ things:\ mean\ (mu)\ and\ log\ variance\ (logvar)\ of\ the\ latent\ space\ distribution.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00019}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a8634d75edc49ff200f27c103f68017d7}{00019}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a8634d75edc49ff200f27c103f68017d7}{encoder}}\ =\ nn.Sequential(}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00020}00020\ \ \ \ \ \ \ \ \ \ \ \ \ nn.Linear(784,\ d\ **\ 2),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00021}00021\ \ \ \ \ \ \ \ \ \ \ \ \ nn.ReLU(),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00022}00022\ \ \ \ \ \ \ \ \ \ \ \ \ nn.Linear(d\ **\ 2,\ d\ *\ 2)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Decoder\ network:\ Maps\ latent\ space\ representations\ back\ to\ the\ input\ space.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00025}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a2b3c12f6e6294eec4d25b80004bab49e}{00025}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a2b3c12f6e6294eec4d25b80004bab49e}{decoder}}\ =\ nn.Sequential(}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \ \ \ \ nn.Linear(d,\ d\ **\ 2),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ \ \ \ \ nn.ReLU(),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ \ \ \ \ nn.Linear(d\ **\ 2,\ 784),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ nn.Sigmoid(),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00032}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a42e11545c6658f37eb00aa75373cd0e8}{00032}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a42e11545c6658f37eb00aa75373cd0e8}{reparameterise}}(self,\ mu,\ logvar):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00034}00034\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Reparameterizes\ the\ latent\ space\ vector\ to\ allow\ backpropagation\ through\ random\ operations.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00035}00035\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ is\ done\ by\ sampling\ from\ the\ distribution\ defined\ by\ mu\ and\ logvar\ using\ the\ reparameterization\ trick.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00036}00036\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00037}00037\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters:}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00038}00038\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ mu:\ Mean\ of\ the\ latent\ space\ distribution.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00039}00039\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ logvar:\ Log\ variance\ of\ the\ latent\ space\ distribution.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00041}00041\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ A\ sampled\ latent\ vector\ (z).}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.training:\ \textcolor{comment}{\#\ Only\ add\ randomness\ during\ training.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ std\ =\ logvar.mul(0.5).exp\_()\textcolor{comment}{\#\ Calculates\ the\ standard\ deviation.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ eps\ =\ std.new\_empty(std.size()).normal\_()\ \textcolor{comment}{\#\ Samples\ epsilon\ from\ a\ standard\ normal\ distribution.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ eps.mul\_(std).add\_(mu)\ \ \textcolor{comment}{\#\ Returns\ z\ =\ mu\ +\ epsilon*std.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00049}00049\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mu\ \textcolor{comment}{\#\ During\ evaluation,\ just\ use\ the\ mean.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00051}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_aa23c363a411e001da145ac76e08e8a82}{00051}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_aa23c363a411e001da145ac76e08e8a82}{forward}}(self,\ x):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00053}00053\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Defines\ the\ forward\ pass\ of\ the\ VAE.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Parameters:}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ x:\ Input\ tensor.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00058}00058\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00059}00059\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ Reconstructed\ input,\ mean\ and\ log\ variance\ of\ the\ latent\ space\ distribution.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00060}00060\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00061}00061\ \ \ \ \ \ \ \ \ mu\_logvar\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a8634d75edc49ff200f27c103f68017d7}{encoder}}(x.view(-\/1,\ 784)).view(-\/1,\ 2,\ d)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ mu\ =\ mu\_logvar[:,\ 0,\ :]}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00063}00063\ \ \ \ \ \ \ \ \ logvar\ =\ mu\_logvar[:,\ 1,\ :]}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00064}00064\ \ \ \ \ \ \ \ \ z\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a42e11545c6658f37eb00aa75373cd0e8}{reparameterise}}(mu,\ logvar)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_v_a_e_a2b3c12f6e6294eec4d25b80004bab49e}{decoder}}(z),\ mu,\ logvar}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00066}00066\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00069}00069\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00070}00070\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00072}00072\ \textcolor{comment}{\#\ \%\%\ DEMO\ TO\ DESIGN\ CNN\ VAE\ MODEL}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00073}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e}{00073}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e}{CNN\_VAE}}(nn.Module):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00074}00074\ \ \ \ \ \textcolor{stringliteral}{'''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00075}00075\ \textcolor{stringliteral}{\ \ \ \ Convolutional\ Variational\ Autoencoder\ (CNN-\/VAE)\ for\ encoding\ input\ data\ to\ a\ latent\ space\ representation}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00076}00076\ \textcolor{stringliteral}{\ \ \ \ and\ decoding\ it\ back\ to\ the\ original\ input\ space.\ This\ class\ uses\ convolutional\ layers\ for\ the\ encoder}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00077}00077\ \textcolor{stringliteral}{\ \ \ \ and\ convolutional\ transpose\ layers\ for\ the\ decoder,\ with\ dense\ layers\ to\ connect\ the\ latent\ space\ representation.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00078}00078\ \textcolor{stringliteral}{\ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00079}00079\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00080}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_aa1c071d7858cbce84b024385f4c6f368}{00080}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_aa1c071d7858cbce84b024385f4c6f368}{\_\_init\_\_}}(self,\ channel\_in,\ latent\_dim,\ hidden\_dims=None):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00081}00081\ \ \ \ \ \ \ \ \ super(CNN\_VAE,\ self).\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_aa1c071d7858cbce84b024385f4c6f368}{\_\_init\_\_}}()}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00082}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a2e504a39b90f70cd480452d6162735dd}{00082}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a2e504a39b90f70cd480452d6162735dd}{latent\_dim}}\ =\ latent\_dim\ \textcolor{comment}{\#\ latent\ space\ vector\ }}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00083}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_aa70a95fdc451a48b1107c79ad989c196}{00083}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_aa70a95fdc451a48b1107c79ad989c196}{channel\_in}}\ =\ channel\_in\ \textcolor{comment}{\#\ number\ of\ colors}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00084}00084\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ hidden\_dims\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ hidden\_dims\ =\ [32,\ 64,\ 128,\ 256]}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00087}00087\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00088}00088\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Encoder:\ Convolutional\ layers\ to\ encode\ input\ into\ a\ latent\ representation}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00089}00089\ \ \ \ \ \ \ \ \ modules\ =\ []}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00090}00090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ h\_dim\ \textcolor{keywordflow}{in}\ hidden\_dims:}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ modules.append(}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.Sequential(}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.Conv2d(channel\_in,\ h\_dim,\ kernel\_size=7,\ stride=2,\ padding=1),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.BatchNorm2d(h\_dim),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.LeakyReLU())}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ channel\_in\ =\ h\_dim}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00098}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a9165bf15f7ed82d3f9fbbeea545864f5}{00098}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a9165bf15f7ed82d3f9fbbeea545864f5}{encoder}}\ =\ nn.Sequential(*modules)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00100}00100\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Transition\ between\ encoder\ and\ decoder:\ Dense\ layers\ for\ mu\ and\ log\ variance\ of\ latent\ space}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00101}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ac7e6357785ddff5a7918c4bb23a56265}{00101}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ac7e6357785ddff5a7918c4bb23a56265}{fc\_mu}}\ =\ nn.Linear(hidden\_dims[-\/1]\ *\ 4,\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a2e504a39b90f70cd480452d6162735dd}{latent\_dim}})}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00102}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a32e2db6a6c497b87b7474fa4d5876c43}{00102}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a32e2db6a6c497b87b7474fa4d5876c43}{fc\_logvar}}\ =\ nn.Linear(hidden\_dims[-\/1]\ *\ 4,\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a2e504a39b90f70cd480452d6162735dd}{latent\_dim}})}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00104}00104\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00105}00105\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Decoder\ Input:\ Prepares\ latent\ dimension\ for\ decoding\ process}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00106}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a058a1d49e6ced8d2a65ec567c27822f0}{00106}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a058a1d49e6ced8d2a65ec567c27822f0}{decoder\_input}}\ =\ nn.Linear(self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a2e504a39b90f70cd480452d6162735dd}{latent\_dim}},\ hidden\_dims[-\/1]*4)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00107}00107\ \ \ \ \ \ \ \ \ modules\ =\ []}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00108}00108\ \ \ \ \ \ \ \ \ hidden\_dims=[256,128,64,64,64]}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00109}00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(hidden\_dims)\ -\/\ 1):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ modules.append(}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.Sequential(}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.ConvTranspose2d(hidden\_dims[i],\ hidden\_dims[i\ +\ 1],\ kernel\_size=3,\ stride=2,\ padding=1,\ output\_padding=1),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.BatchNorm2d(hidden\_dims[i\ +\ 1]),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nn.LeakyReLU()}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00115}00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00116}00116\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00118}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a128b4f88c81444b90279feb8fdff1a80}{00118}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a128b4f88c81444b90279feb8fdff1a80}{decoder}}\ =\ nn.Sequential(*modules)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00120}00120\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00121}00121\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Final\ layer:\ Convolutional\ transpose\ layer\ to\ match\ the\ original\ input's\ shape\ and\ channel}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00122}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ab9ed2c725cb432afcd6b8fd67f6c421f}{00122}}\ \ \ \ \ \ \ \ \ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ab9ed2c725cb432afcd6b8fd67f6c421f}{final\_layer}}\ =\ nn.Sequential(}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ nn.ConvTranspose2d(hidden\_dims[-\/1],\ hidden\_dims[-\/1],\ kernel\_size=31,\ stride=2,\ padding=1,\ output\_padding=0),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ nn.BatchNorm2d(hidden\_dims[-\/1]),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ nn.LeakyReLU(),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ nn.Conv2d(hidden\_dims[-\/1],\ out\_channels=self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_aa70a95fdc451a48b1107c79ad989c196}{channel\_in}},\ kernel\_size=2\ \ \ ,\ stride=1,padding=0),}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ nn.Sigmoid()}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ nn.Tanh()}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00129}00129\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00130}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ae383f8a55ab9ea11ca5e7c465f8519eb}{00130}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ae383f8a55ab9ea11ca5e7c465f8519eb}{encode}}(self,\ x):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00131}00131\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''\ Encodes\ input\ tensor\ into\ a\ latent\ space\ representation\ (mu\ and\ log\_var).}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00132}00132\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:\ }}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00133}00133\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ x:\ input\ tensor\ [B*C*W*L]\ }}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00134}00134\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Return:}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00135}00135\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ mu:\ mean\ of\ latent\ space\ vector\ [B*latent\_dim]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00136}00136\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ log\_var:\ log\ variance\ of\ latent\ space\ vector\ [B*latent\_dim]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00137}00137\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00138}00138\ \ \ \ \ \ \ \ \ x\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a9165bf15f7ed82d3f9fbbeea545864f5}{encoder}}(x)\ \textcolor{comment}{\#[B*C*W*L]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00139}00139\ \ \ \ \ \ \ \ \ x\ =\ torch.flatten(x,\ start\_dim=1)\ \textcolor{comment}{\#[B*hidden\_dims[-\/1]*4]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00140}00140\ \ \ \ \ \ \ \ \ mu\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ac7e6357785ddff5a7918c4bb23a56265}{fc\_mu}}(x)\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00141}00141\ \ \ \ \ \ \ \ \ log\_var\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a32e2db6a6c497b87b7474fa4d5876c43}{fc\_logvar}}(x)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mu,\ log\_var}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00143}00143\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00144}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a19f0949ab576bbf5fe5857eef7576881}{00144}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a19f0949ab576bbf5fe5857eef7576881}{decode}}(self,z):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00145}00145\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''\ \ Decodes\ latent\ space\ vectors\ back\ into\ reconstructed\ images.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00146}00146\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00147}00147\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ z:\ latent\ space\ vector\ [B*latent\_dim]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00148}00148\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Return:}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00149}00149\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ x\_hat:\ reconstructed\ images\ [B*C*W*L]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00150}00150\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00151}00151\ \ \ \ \ \ \ \ \ result\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a058a1d49e6ced8d2a65ec567c27822f0}{decoder\_input}}(z)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00152}00152\ \ \ \ \ \ \ \ \ result\ =\ result.view(-\/1,\ 256,\ 2,\ 2)\ \ \textcolor{comment}{\#\ Here,\ 256\ is\ the\ last\ dimension\ from\ \`{}hidden\_dims`,\ adjust\ accordingly.}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00153}00153\ \ \ \ \ \ \ \ \ result\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a128b4f88c81444b90279feb8fdff1a80}{decoder}}(result)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00154}00154\ \ \ \ \ \ \ \ \ x\_hat\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ab9ed2c725cb432afcd6b8fd67f6c421f}{final\_layer}}(result)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00155}00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x\_hat}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00156}00156\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00157}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a5d376af056d534476136e6a7a7344a77}{00157}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a5d376af056d534476136e6a7a7344a77}{rereparameterize}}(self,\ mu,log\_var):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00158}00158\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'''Reparameterization\ trick\ to\ sample\ from\ N(mu,\ var)\ from\ N(0,1),}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00159}00159\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ training\ purpose,\ add\ a\ random\ noise\ log\_var\ to\ the\ latent\ space\ vector,}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00160}00160\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ for\ evaluation\ purpose,\ only\ use\ the\ mean\ of\ latent\ space\ vector}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00161}00161\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00162}00162\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:\ }}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ mu:\ mean\ of\ latent\ space\ vector\ [B*latent\_dim]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ log\_var:\ log\ variance\ of\ latent\ space\ vector\ [B*latent\_dim]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00165}00165\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Return:}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00166}00166\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ a\ latent\ space\ tesnor\ [B*latent\_dim]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00167}00167\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00168}00168\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ '''}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \ self.training:\ \textcolor{comment}{\#\ only\ for\ training\ purpose}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00170}00170\ \ \ \ \ \ \ \ \ \ \ \ \ std\ =\ torch.exp(0.5*log\_var)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ eps\ =\ torch.randn\_like(std)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00172}00172\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ eps.mul(std).add\_(mu)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00173}00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mu}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00175}00175\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00176}\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ac8abb3fffec61a7ad232b61821b4eee8}{00176}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ac8abb3fffec61a7ad232b61821b4eee8}{forward}}(self,inputs):}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00177}00177\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}\ \ connection\ of\ encoder\ and\ decoder\ inputs\ x\ and\ output\ x\_hat}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00178}00178\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00179}00179\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ inputs:\ input\ tensor\ [B*C*W*L]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00180}00180\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Return:}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00181}00181\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ x\_hat:\ reconstructed\ images\ [B*C*W*L]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00182}00182\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ mu:\ mean\ of\ latent\ space\ vector\ [B*latent\_dim]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00183}00183\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ log\_var:\ log\ variance\ of\ latent\ space\ vector\ [B*latent\_dim]}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00185}00185\ \ \ \ \ \ \ \ \ mu,\ log\_var\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_ae383f8a55ab9ea11ca5e7c465f8519eb}{encode}}(inputs)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00186}00186\ \ \ \ \ \ \ \ \ z\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a5d376af056d534476136e6a7a7344a77}{rereparameterize}}(mu,\ log\_var)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00187}00187\ \ \ \ \ \ \ \ \ x\_hat\ =\ self.\mbox{\hyperlink{classsrc_1_1helper___v_a_estruc_1_1_c_n_n___v_a_e_a19f0949ab576bbf5fe5857eef7576881}{decode}}(z)}
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00188}00188\ }
\DoxyCodeLine{\Hypertarget{helper___v_a_estruc_8py_source_l00189}00189\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ x\_hat,mu,log\_var}

\end{DoxyCode}
